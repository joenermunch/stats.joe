(this.webpackJsonpnewstats=this.webpackJsonpnewstats||[]).push([[0],{21:function(e,t,a){e.exports=a(45)},44:function(e,t,a){},45:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(13),s=a.n(o),c=a(2),l=a.n(c),m=a(3),i=a(14),u=a(15),d=a(19),p=a(16),g=a(20),h=a(17),f=a.n(h),w=(a(44),a(18)),E=a.n(w),b=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={username:null,images:null,stats:null,loading:!1,download:!1,tweet:null},a.callAPI=function(){var e=Object(m.a)(l.a.mark((function e(t){var n,r,o,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a.setState({loading:!0}),e.next=4,f.a.post("/api/data",{username:a.state.username});case 4:n=e.sent,r=n.data.topalbums.album.map((function(e){return e.image[2]["#text"]})),o=n.data.topalbums.album.map((function(e){return{artist:e.artist.name,album:e.name,playcount:e.playcount,image:e.image[2]["#text"]}})),a.setState({images:r,stats:o,loading:!1,download:!0}),s=a.state.stats.map((function(e){return"".concat(e.artist," (").concat(e.playcount,")")})),a.setState({tweet:s.join(", ")});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.makeImage=Object(m.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return window.scrollTo(0,0),e.next=3,E()(document.querySelector("#capture"),{allowTaint:!0,useCORS:!0,scrollX:0,scrollY:0}).then((function(e){var t=e.getContext("2d");t.webkitImageSmoothingEnabled=!1,t.mozImageSmoothingEnabled=!1,t.imageSmoothingEnabled=!1,t.imageSmoothingQuality="high",t.scale(3,3);var a=document.createElement("a");a.href=e.toDataURL("image/png").replace("image/png","image/octet-stream"),a.download="mytopalbums.png",a.click()}));case 3:case"end":return e.stop()}}),e)}))),a.renderDownload=function(){return!0===a.state.download?r.a.createElement("button",{className:"download-button",onClick:a.makeImage},"Download"):r.a.createElement(r.a.Fragment,null)},a.renderImages=function(){return a.state.stats?a.state.stats.map((function(e){return r.a.createElement("div",{style:{background:"url(".concat(e.image,")")},key:e.image,className:"image-item"},r.a.createElement("div",{className:"stats"},r.a.createElement("p",null,e.artist),r.a.createElement("p",{className:"album"},e.album),r.a.createElement("p",{className:"plays"},e.playcount," plays")))})):r.a.createElement(r.a.Fragment,null)},a.renderTopText=function(){return a.state.stats?r.a.createElement("div",{className:"text-container"},"My top artists of the week: ",a.state.tweet," #stats.joe"):r.a.createElement(r.a.Fragment,null)},a.renderTweet=function(){return a.state.stats?(window.twttr=function(e,t,a){var n,r=e.getElementsByTagName(t)[0],o=window.twttr||{};return e.getElementById(a)?o:((n=e.createElement(t)).id=a,n.src="https://platform.twitter.com/widgets.js",r.parentNode.insertBefore(n,r),o._e=[],o.ready=function(e){o._e.push(e)},o)}(document,"script","twitter-wjs"),r.a.createElement("a",{class:"twitter-share-button",href:"https://twitter.com/intent/tweet?text=My top artists of the week: ".concat(a.state.tweet," #joe.io")},"Tweet")):r.a.createElement(r.a.Fragment,null)},a.renderLoading=function(){return!0===a.state.loading?r.a.createElement("p",{className:"loading"},"Loading..."):a.renderDownload()},a}return Object(g.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("div",{className:"main-container"},r.a.createElement("header",null,r.a.createElement("h1",{className:"title"},"stats.joe"),r.a.createElement("form",{onSubmit:function(t){return e.callAPI(t)}},r.a.createElement("input",{placeholder:"Last.FM username",type:"text",onChange:function(t){return e.setState({username:t.target.value})}}),r.a.createElement("button",{className:"submit-button",onClick:this.callAPI},"Generate collage"),r.a.createElement("div",{className:"result"},this.renderLoading())),r.a.createElement("footer",{className:"header-footer"},r.a.createElement("p",{className:"footer-text"},"made with"," ",r.a.createElement("span",{className:"heart",role:"img"},"\u2764\ufe0f")," ","and React by"," ",r.a.createElement("a",{className:"github",target:"_BLANK",rel:"noopener noreferrer",href:"https://github.com/joenermunch"},"joener m\xfcnch")),r.a.createElement("p",null,r.a.createElement("a",{className:"source",target:"_BLANK",rel:"noopener noreferrer",href:"https://github.com/joenermunch/stats.joe"},"source code")))),r.a.createElement("div",{className:"image-main"},r.a.createElement("div",{className:"image-container"},r.a.createElement("div",{className:"image-box",id:"capture"},this.renderImages()),r.a.createElement("div",{className:"text-tweet"},this.renderTopText(),this.renderTweet())))),r.a.createElement("footer",{className:"bottom-footer"},r.a.createElement("p",{className:"footer-text"},"made with"," ",r.a.createElement("span",{className:"heart",role:"img"},"\u2764\ufe0f")," ","and React by"," ",r.a.createElement("a",{className:"github",target:"_BLANK",rel:"noopener noreferrer",href:"https://github.com/joenermunch"},"joener m\xfcnch")),r.a.createElement("p",null,r.a.createElement("a",{className:"source",target:"_BLANK",rel:"noopener noreferrer",href:"https://github.com/joenermunch/stats.joe"},"source code"))))}}]),t}(n.Component);s.a.render(r.a.createElement(b,null),document.querySelector("#root"))}},[[21,1,2]]]);
//# sourceMappingURL=main.7d8d90d0.chunk.js.map