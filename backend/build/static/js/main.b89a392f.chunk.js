(this.webpackJsonpnewstats=this.webpackJsonpnewstats||[]).push([[0],{21:function(e,t,a){e.exports=a(48)},44:function(e,t,a){},48:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(13),c=a.n(s),l=a(2),o=a.n(l),m=a(3),i=a(14),u=a(15),d=a(19),p=a(16),g=a(20),f=a(17),h=a.n(f),w=(a(44),a(18)),E=a.n(w),b=(a(45),function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return(a=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(s)))).state={username:null,images:null,stats:null,loading:!1,download:!1,tweet:null},a.callAPI=function(){var e=Object(m.a)(o.a.mark((function e(t){var n,r,s,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a.setState({loading:!0}),e.next=4,h.a.post("/api/data",{username:a.state.username});case 4:n=e.sent,r=n.data.topalbums.album.map((function(e){return e.image[2]["#text"]})),s=n.data.topalbums.album.map((function(e){return{artist:e.artist.name,album:e.name,playcount:e.playcount,image:e.image[2]["#text"]}})),a.setState({images:r,stats:s,loading:!1,download:!0}),c=a.state.stats.map((function(e){return"".concat(e.artist," (").concat(e.playcount,")")})),a.setState({tweet:c.join(", ")});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.makeImage=Object(m.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E()(document.querySelector("#capture"),{allowTaint:!0,useCORS:!0,scrollX:0,scrollY:0}).then((function(e){var t=document.createElement("a");t.href=e.toDataURL("image/jpeg").replace("image/jpeg","image/octet-stream"),t.download="mytopalbums.jpg",t.click()}));case 2:case"end":return e.stop()}}),e)}))),a.renderDownload=function(){return!0===a.state.download?r.a.createElement("button",{className:"download-button",onClick:a.makeImage},"Download"):r.a.createElement(r.a.Fragment,null)},a.renderImages=function(){return a.state.stats?a.state.stats.map((function(e){return r.a.createElement("div",{style:{background:"url(".concat(e.image,")")},key:e.image,className:"image-item"},r.a.createElement("div",{className:"stats"},r.a.createElement("p",null,e.artist),r.a.createElement("p",{className:"album"},e.album),r.a.createElement("p",{className:"plays"},e.playcount," plays")))})):r.a.createElement(r.a.Fragment,null)},a.renderTopText=function(){return a.state.stats?r.a.createElement("div",{className:"text-container"},"My top artists of the week: ",a.state.tweet," #stats.joe"):r.a.createElement(r.a.Fragment,null)},a.renderTweet=function(){return a.state.stats?(window.twttr=function(e,t,a){var n,r=e.getElementsByTagName(t)[0],s=window.twttr||{};return e.getElementById(a)?s:((n=e.createElement(t)).id=a,n.src="https://platform.twitter.com/widgets.js",r.parentNode.insertBefore(n,r),s._e=[],s.ready=function(e){s._e.push(e)},s)}(document,"script","twitter-wjs"),r.a.createElement("a",{class:"twitter-share-button",href:"https://twitter.com/intent/tweet?text=My top artists of the week: ".concat(a.state.tweet," #joe.io")},"Tweet")):r.a.createElement(r.a.Fragment,null)},a.renderLoading=function(){return!0===a.state.loading?r.a.createElement("p",{className:"loading"},"Loading..."):a.renderDownload()},a}return Object(g.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("div",{className:"main-container"},r.a.createElement("header",null,r.a.createElement("form",{onSubmit:function(t){return e.callAPI(t)}},r.a.createElement("h1",{className:"title"},"stats.joe"),r.a.createElement("input",{placeholder:"Last.FM username",type:"text",onChange:function(t){return e.setState({username:t.target.value})}}),r.a.createElement("button",{className:"submit-button",onClick:this.callAPI},"Generate collage"),r.a.createElement("div",{className:"result"},this.renderLoading()))),r.a.createElement("div",{className:"image-main"},r.a.createElement("div",{className:"image-container"},r.a.createElement("div",{className:"image-box",id:"capture"},this.renderImages()),r.a.createElement("div",{className:"text-tweet"},this.renderTopText(),this.renderTweet())))),r.a.createElement("footer",{className:"header-footer"},r.a.createElement("p",{className:"footer-text"},"made with ",r.a.createElement("span",{className:"heart"},"\u2764\ufe0f")," and React by"," ",r.a.createElement("a",{className:"github",target:"_BLANK",href:"https://github.com/joenermunch"},"joener m\xfcnch")),r.a.createElement("p",null,r.a.createElement("a",{className:"source",target:"_BLANK",href:"https://github.com/joenermunch/stats.joe"},"source code"))))}}]),t}(n.Component));c.a.render(r.a.createElement(b,null),document.querySelector("#root"))}},[[21,1,2]]]);
//# sourceMappingURL=main.b89a392f.chunk.js.map