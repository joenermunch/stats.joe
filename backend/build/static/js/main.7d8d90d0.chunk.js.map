{"version":3,"sources":["Components/App.js","index.js"],"names":["App","state","username","images","stats","loading","download","tweet","callAPI","e","a","preventDefault","setState","axios","post","response","mappedImages","data","topalbums","album","map","image","mappedStats","artist","name","playcount","mappedArtists","join","makeImage","window","scrollTo","html2canvas","document","querySelector","allowTaint","useCORS","scrollX","scrollY","then","canvas","ctx","getContext","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","imageSmoothingEnabled","imageSmoothingQuality","scale","createElement","href","toDataURL","replace","click","renderDownload","className","onClick","renderImages","style","background","key","renderTopText","renderTweet","twttr","d","s","id","js","fjs","getElementsByTagName","t","getElementById","src","parentNode","insertBefore","_e","ready","f","push","class","renderLoading","onSubmit","placeholder","type","onChange","target","value","this","role","rel","Component","ReactDOM","render"],"mappings":"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","file":"static/js/main.7d8d90d0.chunk.js","sourcesContent":["import React, {Component} from \"react\";\r\nimport axios from \"axios\";\r\nimport \"./style.css\";\r\nimport html2canvas from \"html2canvas\";\r\n\r\nexport class App extends Component {\r\n  state = {\r\n    username: null,\r\n    images: null,\r\n    stats: null,\r\n    loading: false,\r\n    download: false,\r\n    tweet: null\r\n  };\r\n\r\n  callAPI = async e => {\r\n    e.preventDefault();\r\n    this.setState({loading: true});\r\n    const response = await axios.post(\"/api/data\", {\r\n      username: this.state.username\r\n    });\r\n\r\n    const mappedImages = response.data.topalbums.album.map(album => {\r\n      return album.image[2][\"#text\"];\r\n    });\r\n\r\n    const mappedStats = response.data.topalbums.album.map(album => {\r\n      return {\r\n        artist: album.artist.name,\r\n        album: album.name,\r\n        playcount: album.playcount,\r\n        image: album.image[2][\"#text\"]\r\n      };\r\n    });\r\n\r\n    this.setState({\r\n      images: mappedImages,\r\n      stats: mappedStats,\r\n      loading: false,\r\n      download: true\r\n    });\r\n\r\n    const mappedArtists = this.state.stats.map(artist => {\r\n      return `${artist.artist} (${artist.playcount})`;\r\n    });\r\n\r\n    this.setState({\r\n      tweet: mappedArtists.join(`, `)\r\n    });\r\n  };\r\n\r\n  makeImage = async () => {\r\n    window.scrollTo(0, 0);\r\n\r\n    await html2canvas(document.querySelector(\"#capture\"), {\r\n      allowTaint: true,\r\n      useCORS: true,\r\n      scrollX: 0,\r\n      scrollY: 0\r\n    }).then(canvas => {\r\n      var ctx = canvas.getContext(\"2d\");\r\n      ctx.webkitImageSmoothingEnabled = false;\r\n      ctx.mozImageSmoothingEnabled = false;\r\n      ctx.imageSmoothingEnabled = false;\r\n      ctx.imageSmoothingQuality = \"high\";\r\n      ctx.scale(3, 3);\r\n\r\n      var a = document.createElement(\"a\");\r\n\r\n      a.href = canvas\r\n        .toDataURL(\"image/png\")\r\n        .replace(\"image/png\", \"image/octet-stream\");\r\n      a.download = \"mytopalbums.png\";\r\n      a.click();\r\n    });\r\n  };\r\n\r\n  renderDownload = () => {\r\n    if (this.state.download === true) {\r\n      return (\r\n        <button className=\"download-button\" onClick={this.makeImage}>\r\n          Download\r\n        </button>\r\n      );\r\n    } else return <></>;\r\n  };\r\n\r\n  renderImages = () => {\r\n    if (this.state.stats) {\r\n      return this.state.stats.map(artist => {\r\n        return (\r\n          <div\r\n            style={{background: `url(${artist.image})`}}\r\n            key={artist.image}\r\n            className=\"image-item\"\r\n          >\r\n            <div className=\"stats\">\r\n              <p>{artist.artist}</p>\r\n              <p className=\"album\">{artist.album}</p>\r\n              <p className=\"plays\">{artist.playcount} plays</p>\r\n            </div>\r\n          </div>\r\n        );\r\n      });\r\n    } else return <></>;\r\n  };\r\n\r\n  renderTopText = () => {\r\n    if (this.state.stats) {\r\n      return (\r\n        <div className=\"text-container\">\r\n          My top artists of the week: {this.state.tweet} #stats.joe\r\n        </div>\r\n      );\r\n    } else return <></>;\r\n  };\r\n\r\n  renderTweet = () => {\r\n    if (this.state.stats) {\r\n      window.twttr = (function(d, s, id) {\r\n        var js,\r\n          fjs = d.getElementsByTagName(s)[0],\r\n          t = window.twttr || {};\r\n        if (d.getElementById(id)) return t;\r\n        js = d.createElement(s);\r\n        js.id = id;\r\n        js.src = \"https://platform.twitter.com/widgets.js\";\r\n        fjs.parentNode.insertBefore(js, fjs);\r\n\r\n        t._e = [];\r\n        t.ready = function(f) {\r\n          t._e.push(f);\r\n        };\r\n\r\n        return t;\r\n      })(document, \"script\", \"twitter-wjs\");\r\n\r\n      return (\r\n        <a\r\n          class=\"twitter-share-button\"\r\n          href={`https://twitter.com/intent/tweet?text=My top artists of the week: ${this.state.tweet} #joe.io`}\r\n        >\r\n          Tweet\r\n        </a>\r\n      );\r\n    } else return <></>;\r\n  };\r\n\r\n  renderLoading = () => {\r\n    if (this.state.loading === true) {\r\n      return <p className=\"loading\">Loading...</p>;\r\n    } else return this.renderDownload();\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <div className=\"main-container\">\r\n          <header>\r\n          <h1 className=\"title\">stats.joe</h1>\r\n            <form onSubmit={e => this.callAPI(e)}>\r\n             \r\n              <input\r\n                placeholder=\"Last.FM username\"\r\n                type=\"text\"\r\n                onChange={e => this.setState({username: e.target.value})}\r\n              />\r\n              <button className=\"submit-button\" onClick={this.callAPI}>\r\n                Generate collage\r\n              </button>\r\n              <div className=\"result\">{this.renderLoading()}</div>\r\n            </form>\r\n            <footer className=\"header-footer\">\r\n              <p className=\"footer-text\">\r\n                made with{\" \"}\r\n                <span className=\"heart\" role=\"img\">\r\n                  ❤️\r\n                </span>{\" \"}\r\n                and React by{\" \"}\r\n                <a\r\n                  className=\"github\"\r\n                  target=\"_BLANK\"\r\n                  rel=\"noopener noreferrer\"\r\n                  href=\"https://github.com/joenermunch\"\r\n                >\r\n                  joener münch\r\n                </a>\r\n              </p>\r\n              <p>\r\n                <a\r\n                  className=\"source\"\r\n                  target=\"_BLANK\"\r\n                  rel=\"noopener noreferrer\"\r\n                  href=\"https://github.com/joenermunch/stats.joe\"\r\n                >\r\n                  source code\r\n                </a>\r\n              </p>\r\n            </footer>\r\n          </header>\r\n          <div className=\"image-main\">\r\n            <div className=\"image-container\">\r\n              <div className=\"image-box\" id=\"capture\">\r\n                {this.renderImages()}\r\n              </div>\r\n\r\n              <div className=\"text-tweet\">\r\n                {this.renderTopText()}\r\n                {this.renderTweet()}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <footer className=\"bottom-footer\">\r\n          <p className=\"footer-text\">\r\n            made with{\" \"}\r\n            <span className=\"heart\" role=\"img\">\r\n              ❤️\r\n            </span>{\" \"}\r\n            and React by{\" \"}\r\n            <a\r\n              className=\"github\"\r\n              target=\"_BLANK\"\r\n              rel=\"noopener noreferrer\"\r\n              href=\"https://github.com/joenermunch\"\r\n            >\r\n              joener münch\r\n            </a>\r\n          </p>\r\n          <p>\r\n            <a\r\n              className=\"source\"\r\n              target=\"_BLANK\"\r\n              rel=\"noopener noreferrer\"\r\n              href=\"https://github.com/joenermunch/stats.joe\"\r\n            >\r\n              source code\r\n            </a>\r\n          </p>\r\n        </footer>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport App from \"./Components/App\";\r\n\r\nReactDOM.render(<App />, document.querySelector(\"#root\"));\r\n"],"sourceRoot":""}