{"version":3,"sources":["Components/App.js","index.js"],"names":["App","state","username","images","stats","loading","download","callAPI","e","a","preventDefault","setState","axios","post","response","mappedImages","data","topalbums","album","map","image","mappedStats","artist","name","playcount","makeImage","html2canvas","document","querySelector","allowTaint","useCORS","scrollX","scrollY","then","canvas","createElement","href","toDataURL","replace","click","renderDownload","className","onClick","renderImages","style","background","key","renderLoading","onSubmit","placeholder","type","onChange","target","value","this","id","Component","ReactDOM","render"],"mappings":"mTA6HeA,G,MAvHf,2MACEC,MAAQ,CACNC,SAAU,KACVC,OAAQ,KACRC,MAAO,KACPC,SAAS,EACTC,UAAU,GANd,EASEC,QATF,uCASY,WAAMC,GAAN,mBAAAC,EAAA,6DACRD,EAAEE,iBACF,EAAKC,SAAS,CAACN,SAAS,IAFhB,SAGeO,IAAMC,KAAK,YAAa,CAC7CX,SAAU,EAAKD,MAAMC,WAJf,OAGFY,EAHE,OAOFC,EAAeD,EAASE,KAAKC,UAAUC,MAAMC,KAAI,SAAAD,GACrD,OAAOA,EAAME,MAAM,GAAG,YAGlBC,EAAcP,EAASE,KAAKC,UAAUC,MAAMC,KAAI,SAAAD,GACpD,MAAO,CACLI,OAAQJ,EAAMI,OAAOC,KACrBL,MAAOA,EAAMK,KACbC,UAAWN,EAAMM,UACjBJ,MAAOF,EAAME,MAAM,GAAG,aAI1B,EAAKT,SAAS,CACZR,OAAQY,EACRX,MAAOiB,EACPhB,SAAS,EACTC,UAAU,IAxBJ,2CATZ,wDAqCEmB,UArCF,sBAqCc,sBAAAhB,EAAA,sEACJiB,IAAYC,SAASC,cAAc,YAAa,CACpDC,YAAY,EACZC,SAAS,EACTC,QAAS,EACTC,QAAS,IACRC,MAAK,SAAAC,GACN,IAAIzB,EAAIkB,SAASQ,cAAc,KAE/B1B,EAAE2B,KAAOF,EACNG,UAAU,cACVC,QAAQ,aAAc,sBACzB7B,EAAEH,SAAW,kBACbG,EAAE8B,WAbM,2CArCd,EAsDEC,eAAiB,WACf,OAA4B,IAAxB,EAAKvC,MAAMK,SAEX,4BAAQmC,UAAU,kBAAkBC,QAAS,EAAKjB,WAAlD,YAIU,sCA7DlB,EAgEEkB,aAAe,WACb,OAAI,EAAK1C,MAAMG,MACN,EAAKH,MAAMG,MAAMe,KAAI,SAAAG,GAC1B,OACE,yBACEsB,MAAO,CAACC,WAAW,OAAD,OAASvB,EAAOF,MAAhB,MAClB0B,IAAKxB,EAAOF,MACZqB,UAAU,cAEV,yBAAKA,UAAU,SACb,2BAAInB,EAAOA,QACX,uBAAGmB,UAAU,SAASnB,EAAOJ,OAC7B,uBAAGuB,UAAU,SAASnB,EAAOE,UAA7B,eAKI,sCAjFlB,EAoFEuB,cAAgB,WACd,OAA2B,IAAvB,EAAK9C,MAAMI,QACN,uBAAGoC,UAAU,WAAb,cACK,EAAKD,kBAvFvB,wEA0FY,IAAD,OACP,OACE,yBAAKC,UAAU,kBACb,gCACE,0BAAMO,SAAU,SAAAxC,GAAC,OAAI,EAAKD,QAAQC,KAChC,wBAAIiC,UAAU,SAAd,aACA,2BACEQ,YAAY,mBACZC,KAAK,OACLC,SAAU,SAAA3C,GAAC,OAAI,EAAKG,SAAS,CAACT,SAAUM,EAAE4C,OAAOC,WAEnD,4BAAQZ,UAAU,gBAAgBC,QAASY,KAAK/C,SAAhD,oBAGA,yBAAKkC,UAAU,UAAUa,KAAKP,mBAGlC,yBAAKN,UAAU,cACb,yBAAKA,UAAU,mBACb,yBAAKA,UAAU,YAAYc,GAAG,WAC3BD,KAAKX,uBA9GpB,GAAyBa,cCFzBC,IAASC,OAAO,kBAAC,EAAD,MAAS/B,SAASC,cAAc,Y","file":"static/js/main.3fa51b6b.chunk.js","sourcesContent":["import React, {Component} from \"react\";\r\nimport axios from \"axios\";\r\nimport \"./style.css\";\r\nimport html2canvas from \"html2canvas\";\r\nimport canvasToImage from \"canvas-to-image\";\r\n\r\nexport class App extends Component {\r\n  state = {\r\n    username: null,\r\n    images: null,\r\n    stats: null,\r\n    loading: false,\r\n    download: false\r\n  };\r\n\r\n  callAPI = async e => {\r\n    e.preventDefault();\r\n    this.setState({loading: true});\r\n    const response = await axios.post(\"/api/data\", {\r\n      username: this.state.username\r\n    });\r\n\r\n    const mappedImages = response.data.topalbums.album.map(album => {\r\n      return album.image[2][\"#text\"];\r\n    });\r\n\r\n    const mappedStats = response.data.topalbums.album.map(album => {\r\n      return {\r\n        artist: album.artist.name,\r\n        album: album.name,\r\n        playcount: album.playcount,\r\n        image: album.image[2][\"#text\"]\r\n      };\r\n    });\r\n\r\n    this.setState({\r\n      images: mappedImages,\r\n      stats: mappedStats,\r\n      loading: false,\r\n      download: true\r\n    });\r\n  };\r\n\r\n  makeImage = async () => {\r\n    await html2canvas(document.querySelector(\"#capture\"), {\r\n      allowTaint: true,\r\n      useCORS: true,\r\n      scrollX: 0,\r\n      scrollY: 0\r\n    }).then(canvas => {\r\n      var a = document.createElement(\"a\");\r\n\r\n      a.href = canvas\r\n        .toDataURL(\"image/jpeg\")\r\n        .replace(\"image/jpeg\", \"image/octet-stream\");\r\n      a.download = \"mytopalbums.jpg\";\r\n      a.click();\r\n    });\r\n  };\r\n\r\n  renderDownload = () => {\r\n    if (this.state.download === true) {\r\n      return (\r\n        <button className=\"download-button\" onClick={this.makeImage}>\r\n          Download\r\n        </button>\r\n      );\r\n    } else return <></>;\r\n  };\r\n\r\n  renderImages = () => {\r\n    if (this.state.stats) {\r\n      return this.state.stats.map(artist => {\r\n        return (\r\n          <div\r\n            style={{background: `url(${artist.image})`}}\r\n            key={artist.image}\r\n            className=\"image-item\"\r\n          >\r\n            <div className=\"stats\">\r\n              <p>{artist.artist}</p>\r\n              <p className=\"album\">{artist.album}</p>\r\n              <p className=\"plays\">{artist.playcount} plays</p>\r\n            </div>\r\n          </div>\r\n        );\r\n      });\r\n    } else return <></>;\r\n  };\r\n\r\n  renderLoading = () => {\r\n    if (this.state.loading === true) {\r\n      return <p className=\"loading\">Loading...</p>;\r\n    } else return this.renderDownload();\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"main-container\">\r\n        <header>\r\n          <form onSubmit={e => this.callAPI(e)}>\r\n            <h1 className=\"title\">stats.joe</h1>\r\n            <input\r\n              placeholder=\"Last.FM username\"\r\n              type=\"text\"\r\n              onChange={e => this.setState({username: e.target.value})}\r\n            />\r\n            <button className=\"submit-button\" onClick={this.callAPI}>\r\n              Generate collage\r\n            </button>\r\n            <div className=\"result\">{this.renderLoading()}</div>\r\n          </form>\r\n        </header>\r\n        <div className=\"image-main\">\r\n          <div className=\"image-container\">\r\n            <div className=\"image-box\" id=\"capture\">\r\n              {this.renderImages()}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport App from \"./Components/App\";\r\n\r\nReactDOM.render(<App />, document.querySelector(\"#root\"));\r\n"],"sourceRoot":""}